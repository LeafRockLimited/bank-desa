import{_ as v}from"./AdminLayout-D7x4X-Vj.js";import{Z as k,i as y,b as m,r as i,o as D,d as R,e as l,w as r,F as P,a,h as B,t as d,g as T,m as V}from"./app-B2goeVmr.js";import{T as C,C as H}from"./CardBody-CpEReZhc.js";import{P as F}from"./PrimaryButton-ChptpEbZ.js";import{H as u}from"./Helper-BlyvImFi.js";import{T as L,B as I}from"./BulanFilter-CbEp2ULk.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BUQp7NpC.js";import"./ResponsiveNavLink-BwJSSKKb.js";import"./SecondaryButton-NRDCaHm7.js";const M={components:{AuthenticatedLayout:v,Head:k,Link:y,Table:C,CardBody:H,PrimaryButton:F,TahunFilter:L,BulanFilter:I},data(){return{dataPinjaman:[],dataRow:[],dataRekap:{jumlah_pinjaman:0,total_pengajuan:0,uang_diterima_nasabah:0,keuntungan:0,year:null},page:1,length:10,searchQuery:null,tahun:this.$moment().year(),bulan:null,status:null}},computed:{headers(){return["nasabah.nama_lengkap","jenis_pinjaman","jumlah_pinjaman","bunga","nominal_diterima","status_pinjaman","tanggal_jatuh_tempo","tanggal_pengajuan"]},startRow(){return this.dataPinjaman.from??1},endRow(){return this.dataPinjaman.to??0},totalData(){return this.dataPinjaman.total??0},links(){return this.dataPinjaman.links??[]}},watch:{page(e){this.getData()},length(e){this.page=1,this.getData()},searchQuery(e){this.page=1,this.getData()},tahun(e){this.page=1,this.getData(),this.getRekapData()},bulan(e){this.page=1,this.getData(),this.getRekapData()},status(e){this.page=1,this.getData(),this.getRekapData()}},beforeMount(){this.getData(),this.getRekapData()},methods:{async getData(){const e=route("pinjaman.show",{page:this.page,length:this.length,searchQuery:this.searchQuery,tahun:this.tahun,bulan:this.bulan,status:this.status}),p=(await m.get(e)).data;this.dataPinjaman=p,this.mappingData()},mappingData(){var e,t;if(this.dataRow=[],((t=(e=this.dataPinjaman)==null?void 0:e.data)==null?void 0:t.length)>0){let p=this.dataPinjaman.data.map(o=>(o.nominal_diterima=u.rupiah(parseInt(o.nominal_diterima)),o.tanggal_jatuh_tempo=u.tanggal(o.tanggal_jatuh_tempo),o.tanggal_pengajuan=u.tanggal(o.tanggal_pengajuan),o.jumlah_pinjaman=u.rupiah(parseInt(o.jumlah_pinjaman)),o));this.dataRow=p}else return[]},async getRekapData(){const t=(await m.get(route("pinjaman.show_rekap",{tahun:this.tahun,bulan:this.bulan,status:this.status}))).data;this.dataRekap={jumlah_pinjaman:u.rupiah(parseInt(t.jumlah_pinjaman)),total_pengajuan:t.total_pengajuan,uang_diterima_nasabah:u.rupiah(parseInt(t.uang_diterima_nasabah)),keuntungan:u.rupiah(parseInt(t.keuntungan)),year:t.year}}}},Q=a("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Pinjaman Nasabah",-1),q={class:"flex flex-row space-x-4"},A={class:"w-fit"},N=a("p",{class:"text-lg font-bold"},"Isi formulir peminjaman",-1),S=a("p",null,"Tambahkan data pinjaman nasabah dengan menekan tombol dibawah ini, pastikan semua formulir diisi dengan valid",-1),O={class:"mt-4"},U={class:"space-y-3"},Z={class:"text-md lg:text-lg font-bold"},E={class:"grid grid-cols-1 gap-6 lg:flex lg:flex-row lg:justify-between"},J=a("p",{class:"text-gray-500"},"Total pengajuan pinjaman",-1),G={class:"font-bold text-xl"},K=a("hr",{class:"max-lg:show"},null,-1),W=a("p",{class:"text-gray-500"},"Uang dipinjamkan (Total)",-1),X={class:"font-bold text-xl lg:text-right"},Y=a("hr",{class:"max-lg:show"},null,-1),$=a("p",{class:"text-gray-500"},"Jumlah nominal pengembalian",-1),aa={class:"font-bold text-xl lg:text-right"},ta=a("hr",{class:"max-lg:show"},null,-1),na=a("p",{class:"text-gray-500"},"Potensi keuntungan",-1),ea={class:"font-extrabold text-xl text-indigo-700 lg:text-right"},sa=["href"],oa=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 32 32"},[a("path",{fill:"#20744a","fill-rule":"evenodd",d:"M28.781 4.405h-10.13V2.018L2 4.588v22.527l16.651 2.868v-3.538h10.13A1.16 1.16 0 0 0 30 25.349V5.5a1.16 1.16 0 0 0-1.219-1.095m.16 21.126H18.617l-.017-1.889h2.487v-2.2h-2.506l-.012-1.3h2.518v-2.2H18.55l-.012-1.3h2.549v-2.2H18.53v-1.3h2.557v-2.2H18.53v-1.3h2.557v-2.2H18.53v-2h10.411Z"}),a("path",{fill:"#20744a",d:"M22.487 7.439h4.323v2.2h-4.323zm0 3.501h4.323v2.2h-4.323zm0 3.501h4.323v2.2h-4.323zm0 3.501h4.323v2.2h-4.323zm0 3.501h4.323v2.2h-4.323z"}),a("path",{fill:"#fff","fill-rule":"evenodd",d:"m6.347 10.673l2.146-.123l1.349 3.709l1.594-3.862l2.146-.123l-2.606 5.266l2.606 5.279l-2.269-.153l-1.532-4.024l-1.533 3.871l-2.085-.184l2.422-4.663z"})],-1),la=a("span",null,"Download",-1),ia=[oa,la],ra=a("option",{selected:"",value:null}," Status Pinjaman ",-1),ha=a("option",{value:"pending"}," Menunggu ",-1),ua=a("option",{value:"approved"}," Diterima ",-1),da=a("option",{value:"rejected"}," Ditolak ",-1),pa=a("option",{value:"paid"}," Lunas ",-1),ga=[ra,ha,ua,da,pa];function ma(e,t,p,o,n,h){const _=i("Head"),c=i("PrimaryButton"),j=i("Link"),g=i("CardBody"),f=i("TahunFilter"),b=i("BulanFilter"),w=i("Table"),x=i("AuthenticatedLayout");return D(),R(P,null,[l(_,{title:"Pinjaman"}),l(x,null,{header:r(()=>[Q]),default:r(()=>[l(g,null,{content:r(()=>[a("div",q,[a("div",A,[N,S,a("div",O,[l(j,{href:e.route("pinjaman.create")},{default:r(()=>[l(c,{class:""},{default:r(()=>[B("+ Formulir Peminjaman")]),_:1})]),_:1},8,["href"])])])])]),_:1}),l(g,null,{content:r(()=>[a("div",U,[a("div",null,[a("p",Z,"Rekap pinjaman nasabah tahun "+d(n.tahun),1)]),a("div",E,[a("div",null,[J,a("p",G,d(n.dataRekap.total_pengajuan??0)+" Pengajuan",1)]),K,a("div",null,[W,a("p",X,d(n.dataRekap.uang_diterima_nasabah),1)]),Y,a("div",null,[$,a("p",aa,d(n.dataRekap.jumlah_pinjaman),1)]),ta,a("div",null,[na,a("p",ea,d(n.dataRekap.keuntungan),1)])])])]),_:1}),l(g,null,{content:r(()=>[l(w,{headers:h.headers,data:n.dataRow,startRow:h.startRow,links:h.links,lengthProps:e.lengthProps,deleteData:!0,deleteRoute:"pinjaman.delete",editData:!0,editRoute:"pinjaman.edit",totalData:h.totalData,endRow:h.endRow,actionUsingId:!0,onRefreshedData:t[3]||(t[3]=()=>{h.getData(),h.getRekapData()}),onClickPage:t[4]||(t[4]=s=>{n.page=s}),onChangeLength:t[5]||(t[5]=s=>{n.length=s}),onOnSearch:t[6]||(t[6]=s=>{n.searchQuery=s})},{filter:r(()=>[a("a",{href:e.route("pinjaman.download",{tahun:n.tahun,bulan:n.bulan,status:n.status}),class:"border px-3 rounded-md border-gray-300 bg-gray-50 inline-flex items-center text-gray-600 space-x-1"},ia,8,sa),l(f,{onOnChange:t[0]||(t[0]=s=>{n.tahun=s})}),l(b,{onOnChange:t[1]||(t[1]=s=>{n.bulan=s})}),T(a("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.status=s),class:"min-w-40 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5"},ga,512),[[V,n.status]])]),_:1},8,["headers","data","startRow","links","lengthProps","totalData","endRow"])]),_:1})]),_:1})],64)}const Da=z(M,[["render",ma]]);export{Da as default};
